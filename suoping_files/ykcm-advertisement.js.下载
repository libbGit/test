var tex_d=$.trim($("#tex_c").text());
if(typeof idFlag!="undefined" && idFlag == '1'&&tex_d !='null'){
    // text_c = text_c.replace(/\s*/g,"");
    text_c=$.trim($("#tex_c").text());
}else {
    if($("#tex_c").text().split(";").length>0){
        var text_c = $.trim($("#tex_c").text());
        text_c=text_c.split(';')[0];
    }else {
        text_c=tex_d
    }
}
var text_e = document.getElementsByClassName('header_a')[0];
var text_d = text_e.innerHTML;
// /获取当前页面url后面的参数-----------------------------------------------
function GetQueryString(name) {
    var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
    //截取URL里面&后面的值
    var r = window.location.search.substr(1).match(reg);
    if(r != null) return(r[2]);
    return null;
}
var channelno = GetQueryString("channelCode"); //获取第几个集合test_group
//if(channelno == null || channelno == '') {
//	channelno = 'huawei';
//}
/*
var reportS = 'https://admonitor.bizhiquan.com/v1/monitor'; //http://admonitor.bizhiquan.com/v1/monitor
var getAjax = 'https://dsp.bizhiquan.com/v1/h5'; //http://192.168.50.18:8081/v1/h5
*/
var hrefUrls = window.location.href;
var encodeUrl = encodeURI(hrefUrls);
//判断https或是http
//if(hrefUrls.indexOf("http://") >= 0) {
//	reportS = 'http://192.168.50.18:8083/v1/monitor';
//	getAjax = 'http://192.168.50.18:8081/v1/h5';
//}
var positions = "F1,F2,F3,F4,F5,H2,M2";
var product = "1";
var uid = "";
var cookieT = '';
var cookieM = '';
var NameOfCookie = "uid";
var ykcm_c = document.cookie.indexOf(NameOfCookie + "=");
//注册cookie
if(ykcm_c != -1) {
    getcookie('uid');
    //未注册cookie
} else {
    var s_number = (Math.floor(Math.random() * 10000) % 9 + 1).toString();
    for(var i = 0; i < 8; i++) {
        s_number = s_number + (Math.floor(Math.random() * 10000) % 10).toString();
    }
    document.cookie = 'uid=' + s_number + ''; //设置cookie
    getcookie('uid');
}

//getcookie('sss');
function getcookie(c_name) { //获取cookie的值
    if(document.cookie.length > 0) {
        c_start = document.cookie.indexOf(c_name + "=");
        if(c_start != -1) {
            c_start = c_start + c_name.length + 1;
            c_end = document.cookie.indexOf(";", c_start);
            if(c_end == -1) c_end = document.cookie.length;
            cookieT = document.cookie.substring(c_start, c_end);
        }
    }
}
cookieM = 'u' + cookieT;
var macodeQ = '';
//判断广告是否展示
var adUrlA = GetQueryString("ad");
var adUrl = adUrlA.toLocaleLowerCase();
if(adUrl == 'yes') {
    var banner="<div id=\"oppoBanner\" class=\"oppoBanner\"></div>";
    $("body").append(banner);
    /*根据渠道号判断不同渠道号插入不同厂商的广告*/
    if(channelno == 'oppo_test'){
        var get = hrefUrls; //testUrl
        get = get.match(/article_(\S*).html/)[1];
        var strDiv = '';
        var offs = true;
        window.oppoAd.render({
            id: 'oppoBanner', //必填，页面容器ID
            posId: '7505_7506_10278_10279', //必填，广告位OPPO自定义，便于追踪广告效果
            pageId: get,
            supportTypes: '1',
            supportSpecs: '1,2,3',
            docTitle:text_d,
            docCat:[text_c]
        })
        console.log(window.oppoAd)
        var sNum = new Number(10);
        var wait = setInterval(function() {

            sNum--;
            console.log('倒计时:' + sNum + '秒 定时查询');
            if(sNum == 0) {
                console.log("未获取到oppo广告数据")
                clearInterval(wait);
            } else {
                console.log("查看是否有数据")
                if($(".oppoBanner").html() != '') {
                    console.log("oppo广告已展示");
                    //oppo广告点击上报
                    //					var hrefT = $('#oppoBanner').find('a').attr('href');
                    //					var hrefK = $('#oppoBanner').find('a').attr('href','javascript:;');
                    var cls = $('#oppoBanner').children().eq(0).attr('class');
                    var cArr = cls.split(' ');
                    var classN = cArr[0];
                    var hrefK = $('#oppoBanner').find('a').attr('id', 'rt');
                    document.getElementById('rt').addEventListener('click', function() {
                        var typeO = '4';
                        if(offs) {
                            oppoReport(typeO);
                            offs = false;
                        }
                    })
                    //oppo上报接口
                    function oppoReport(type) {
                        $.ajax({
                            url: 'https://3ad.bizhiquan.com/monitor/oppo_ad?',
                            data: {
                                c: 'oppo',
                                uid: cookieM,
                                url: hrefUrls,
                                type: type
                            },
                            type: 'POST',
                            dataType: 'json',
                            success: function(data) {
                                console.log('oppo广告已上报');

                            },
                            error: function(data) {
                                console.log("错误提示", "获取识别结果失败，请重试！");
                            }
                        });
                    }
                    //清除定时器
                    clearInterval(wait);
                    //调用方法
                    //oppo广告曝光监控
                    var isFirst = true;
                    var win = $(window);
                    var st = $('#oppoBanner');
                    var elementst = st.height() / 2;
                    //					var elementst = st.height();
                    var heightc = st.offset().top + elementst;
                    if(heightc <= win.height() + win.scrollTop()) {
                        var typeP = '1';
                        var t2 = window.setTimeout(time, 1000);

                        function time() {
                            oppoReport(typeP);
                        }
                        isFirst = false;
                    }
                    win.scroll(function() {
                        if(heightc <= win.height() + win.scrollTop()) {
                            if(isFirst) { //=======================只允许执行一次
                                var typeP = '1';
                                var t1 = window.setTimeout(time, 1000);

                                function time() {
                                    oppoReport(typeP);
                                }
                                isFirst = false;

                            }
                        }
                    })

                }
            }

        }, 1000);
    }else if(channelno == 'oppo_ex' || channelno == 'oppo_photos_dist'|| channelno == 'oppo_ac'|| channelno == 'osp') {
        //document.write("<script src='https://adsfs.oppomobile.com/mp/app/partner/lockscreen/index.js'><\/script>");
        var get = hrefUrls; //testUrl
        //get = get.match(/article_(\S*).html/)[1];
        if(GetQueryString("id") == null) {
            if(testUrl.indexOf("article_") != -1) {
                get = get.substring(get.indexOf("article_") + 8, get.indexOf(".html"));
            }
        } else {
            get = GetQueryString("id"); //获取参数id
        }
        var strDiv = '';
        var offs = true;
        window.oppoAd.render({
            id: 'oppoBanner', //必填，页面容器ID
            posId: '7505_7506_10278_10279', //必填，广告位OPPO自定义，便于追踪广告效果
            pageId: get,
            supportTypes: '1',
            supportSpecs: '1,2,3'/*,
            docTitle:text_d,
            docCat:[text_c]*/
        })
        console.log(window.oppoAd)
        var sNum = new Number(30);
        var wait = setInterval(function() {
            sNum--;
            //console.log('倒计时:' + sNum + '秒 定时查询');
            if(sNum == 7){
                var system ={
                    win : false,
                    mac : false,
                    xll : false
                };
                var p = navigator.platform;
                system.win = p.indexOf("Win") == 0;
                system.mac = p.indexOf("Mac") == 0;
                system.x11 = (p == "X11") || (p.indexOf("Linux") == 0);
                if(system.win||system.mac||system.xll){
                }else{
                    //var hm = document.createElement("script");
                    //var s = document.getElementsByTagName("script")[0];
                    //hm.src = "https://unock.bizhiquan.com/common/js/this_Advertisement.js";
                    //s.parentNode.insertBefore(hm, s);
                    //$("#oppoBanner").remove();
                }
            }
            if(sNum == 0) {
                console.log("未获取到oppo广告数据")
                clearInterval(wait);
            } else {
                //console.log("查看是否有数据")
                if($(".oppoBanner").html() != '') {
                    console.log("oppo广告已展示");
                    $("#oppoBanner .oppoad-list").css('border-bottom','0');
                    //oppo广告点击上报
                    //					var hrefT = $('#oppoBanner').find('a').attr('href');
                    //					var hrefK = $('#oppoBanner').find('a').attr('href','javascript:;');
                    var cls = $('#oppoBanner').children().eq(0).attr('class');
                    var cArr = cls.split(' ');
                    var classN = cArr[0];
                    var hrefK = $('#oppoBanner').find('a').attr('id', 'rt');
                    document.getElementById('rt').addEventListener('click', function() {
                        var typeO = '4';
                        if(offs) {
                            oppoReport(typeO);
                            offs = false;
                        }
                    })
                    //oppo上报接口
                    function oppoReport(type) {
                        $.ajax({
                            url: 'https://3ad.bizhiquan.com/monitor/oppo_ad?',
                            data: {
                                c: 'oppo',
                                uid: cookieM,
                                url: hrefUrls,
                                type: type
                            },
                            type: 'POST',
                            dataType: 'json',
                            success: function(data) {
                                console.log('oppo广告已上报');

                            },
                            error: function(data) {
                                console.log("错误提示", "获取识别结果失败，请重试！");
                            }
                        });
                    }
                    //清除定时器
                    clearInterval(wait);
                    //调用方法
                    //oppo广告曝光监控
                    var isFirst = true;
                    var win = $(window);
                    var st = $('#oppoBanner');
                    var elementst = st.height() / 2;
                    //					var elementst = st.height();
                    var heightc = st.offset().top + elementst;
                    if(heightc <= win.height() + win.scrollTop()) {
                        var typeP = '1';
                        var t2 = window.setTimeout(time, 1000);

                        function time() {
                            oppoReport(typeP);
                        }
                        isFirst = false;
                    }
                    win.scroll(function() {
                        if(heightc <= win.height() + win.scrollTop()) {
                            if(isFirst) { //=======================只允许执行一次
                                var typeP = '1';
                                var t1 = window.setTimeout(time, 1000);

                                function time() {
                                    oppoReport(typeP);
                                }
                                isFirst = false;

                            }
                        }
                    })

                }
            }

        }, 1000);
    } else if(channelno == 'vivo' || channelno == 'vivo_18_9'||channelno == 'vivo_dist'||channelno=='vivo_new'||channelno=='vivo_test') {
        var str='<div id="vivoBanner"></div>';
        $('#oppoBanner').append(str);
        var offs=true;
        /*插入vivo广告*/
        var viv = '<script type="text/javascript" id="c583d15b8cdb40a4bfb0ebbfd0a84bc5" name="vivo-ad" class="self-style"></script>'
        $('#vivoBanner').html(viv);
        $('#vivoBanner').addClass("boxMargin");
        /*vivo广告监控上报曝光*/
        var sNum = new Number(10);
        var wait = setInterval(function() {
            sNum--;
            console.log('倒计时:' + sNum + '秒 定时查询');
            if(sNum == 7){ 
                var system ={
                    win : false,
                    mac : false,
                    xll : false
                };
                var p = navigator.platform;
                system.win = p.indexOf("Win") == 0;
                system.mac = p.indexOf("Mac") == 0;
                system.x11 = (p == "X11") || (p.indexOf("Linux") == 0);
                if(system.win||system.mac||system.xll){
                }else{
                    var hm = document.createElement("script");
                    var s = document.getElementsByTagName("script")[0];
                    hm.src = "https://unock.bizhiquan.com/common/js/this_Advertisement.js";
                    s.parentNode.insertBefore(hm, s);
                    $("#oppoBanner").remove();
                    $("#vivoBanner").remove();
                }
            }
            if(sNum == 0) {
                console.log("未获取到vivo广告数据");
                clearInterval(wait);
            } else {
                console.log("查看是否有数据")
                if($("#vivoBanner>div").length > 0) {
                    console.log("vivo广告已展示");
                    var cls = $('#vivoBanner').children().eq(0).attr('class');
                    var cArr = cls.split(' ');
                    var classN = cArr[0];
                    var hrefK = $('#vivoBanner').find('a').attr('id', 'rt');

                    $("#oppoBanner").click(function(){
                        var typeO = '4';
                        if(offs) {
                            oppoReport(typeO);
                            offs = false;
                        }
                    });

                    //vivo上报接口
                    function oppoReport(type) {
                        $.ajax({
                            url: 'https://3ad.bizhiquan.com/monitor/oppo_ad?',
                            data: {
                                c: 'vivo',
                                uid: cookieM,
                                url: hrefUrls,
                                type: type
                            },
                            type: 'POST',
                            dataType: 'json',
                            success: function(data) {
                                console.log('vivo广告已上报');

                            },
                            error: function(data) {
                                console.log("错误提示", "获取识别结果失败，请重试！");
                            }
                        });
                    }
                    //清除定时器
                    clearInterval(wait);
                    //调用方法
                    //vivo广告曝光监控
                    var isFirst = true;
                    var win = $(window);
                    var st = $('#vivoBanner');
                    var elementst = st.height() / 2;
                    //					var elementst = st.height();
                    var heightc = st.offset().top + elementst;
                    if(heightc <= win.height() + win.scrollTop()) {
                        var typeP = '1';
                        var t2 = window.setTimeout(time, 1000);

                        function time() {
                            oppoReport(typeP);
                        }
                        isFirst = false;
                    }
                    win.scroll(function() {
                        if(heightc <= win.height() + win.scrollTop()) {
                            if(isFirst) { //=======================只允许执行一次
                                var typeP = '1';
                                var t1 = window.setTimeout(time, 1000);

                                function time() {
                                    oppoReport(typeP);
                                }
                                isFirst = false;

                            }
                        }
                    })

                }
            }

        }, 1000);
    }
    else if(channelno == 'gionee-no'||channelno == 'gionee_m2017-no') {
        /*插入金立广告*/
        var gio = '<script class="j-getAdParam" async="async" src="https://sspzx.gionee.com/JS_Ad/build/index.js?app_id=4305&adslot_id=4785"></script>'
        $('#oppoBanner').html(gio);

        var offs = true;
        var sNum = new Number(10);
        var wait = setInterval(function() {

            sNum--;
            console.log('倒计时:' + sNum + '秒 定时查询');
            if(sNum == 0) {
                console.log("未获取到gionee广告数据")
                clearInterval(wait);
            } else {
                console.log("查看是否有数据")
                if($("#oppoBanner>div").length > 0) {
                    console.log("gionee广告已展示");
                    //gionee广告点击上报
                    var cls = $('#oppoBanner').children().eq(0).attr('class');
                    var cArr = cls.split(' ');
                    var classN = cArr[0];
                    var hrefK = $('#oppoBanner').find('a').attr('id', 'rt');
                    $("#oppoBanner").on("click","#rt",function(){
                        var typeO = '4';
                        if(offs) {
                            oppoReport(typeO);
                            offs = false;
                        }
                    });
                    function oppoReport(type) {
                        $.ajax({
                            url: 'https://3ad.bizhiquan.com/monitor/oppo_ad?',
                            data: {
                                c: 'gionee',
                                uid: cookieM,
                                url: hrefUrls,
                                type: type
                            },
                            type: 'POST',
                            dataType: 'json',
                            success: function(data) {
                                console.log('gionee广告已上报');

                            },
                            error: function(data) {
                                console.log("错误提示", "获取识别结果失败，请重试！");
                            }
                        });
                    }
                    //清除定时器
                    clearInterval(wait);
                    //调用方法
                    //gionee广告曝光监控
                    var isFirst = true;
                    var win = $(window);
                    var st = $('#oppoBanner');
                    var elementst = st.height() / 2;
                    //					var elementst = st.height();
                    var heightc = st.offset().top + elementst;
                    if(heightc <= win.height() + win.scrollTop()) {
                        var typeP = '1';
                        var t2 = window.setTimeout(time, 1000);

                        function time() {
                            oppoReport(typeP);
                        }
                        isFirst = false;
                    }
                    win.scroll(function() {
                        if(heightc <= win.height() + win.scrollTop()) {
                            if(isFirst) { //=======================只允许执行一次
                                var typeP = '1';
                                var t1 = window.setTimeout(time, 1000);

                                function time() {
                                    oppoReport(typeP);
                                }
                                isFirst = false;

                            }
                        }
                    })

                }
            }

        }, 1000);
    }
    //=================阻止页面滑动点击
    $(".boxZz").bind("touchmove", function(e) {
        e.preventDefault();
    });

    //		}
} else if(adUrl == 'no') {
    console.log("关闭广告");
} else {
    console.log("未获取到ad值");
}
//点击关闭水晶球
$('.shut').click(function() {
    $('.ggs_f').hide();
})

/*window.onload = function() {
    if(channelno == 'hisense') {
        $.ajax({
            url: "https://adpush.bizhiquan.com/plan/h5List?channelCode=" + channelno,
            data: {},
            type: "get",
            dataType: "json",
            success: function(data) {
                for(var i = 0; i < data.length; i++) {
                    (function(a) {
                        setTimeout(timeI, a * 5000);

                        function timeI() {
                            var str = $('<iframe  class="iframeY' + a + ' iframeP" id="" style="border: none;width: 100%;height: 0;display: none;" src="' + data[a] + '.html"></iframe>');
                            $(".boxs").append(str);
                            setTimeout(function() {
                                str.remove();
                            }, 5000);
                        }
                    })(i);
                }
            },
            error: function(data) {
                console.log("错误提示", "获取识别结果失败，请重试！");
            }
        });

    }
}*/
 
